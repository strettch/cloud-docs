## Understanding Subdomain Zones

### What is a Subdomain Zone?

A subdomain zone is when you manage a subdomain (like `project.example.com`) as a completely separate DNS zone with its own nameservers, independent from the parent domain.

### How DNS Delegation Works

When a DNS query is made, it follows a delegation chain from your domain registrar through various nameservers to resolve the final IP address.

**Mermaid Diagram:**

```mermaid
graph TB
    subgraph "Domain Registrar"
        DR[example.com<br/>NS: ns1.cloudflare.com<br/>NS: ns2.cloudflare.com]
    end

    subgraph "Cloudflare DNS Zone"
        CF[example.com Zone]
        CF_A[A: example.com → 200.10.10.10]
        CF_NS[NS: project.example.com<br/>→ ns1.strettch.com<br/>→ ns2.strettch.com]
    end

    subgraph "Strettch Cloud DNS Zone"
        SC[project.example.com Zone]
        SC_A1[A: db.project.example.com<br/>→ 120.20.20.20]
        SC_A2[A: api.project.example.com<br/>→ 120.20.20.21]
    end

    DR -->|Delegates to| CF
    CF --> CF_A
    CF --> CF_NS
    CF_NS -->|Delegates subdomain| SC
    SC --> SC_A1
    SC --> SC_A2

    style DR fill:#e1f5ff
    style CF fill:#fff4e1
    style SC fill:#e8f5e9
```

**ASCII Diagram:**

```
┌─────────────────────────────────────────────────────────────┐
│ Domain Registrar (example.com)                              │
├─────────────────────────────────────────────────────────────┤
│ NS │ ns1.cloudflare.com ──────────┐                         │
│ NS │ ns2.cloudflare.com ──────────┤                         │
└───────────────────────────────────┼─────────────────────────┘
                                    │
                         ┌──────────▼──────────────────────────────────────────┐
                         │ Cloudflare DNS (example.com zone)                   │
                         ├─────────────────────────────────────────────────────┤
                         │ A  │ example.com         │ 200.10.10.10            │
                         │ A  │ example.com         │ 200.10.10.11            │
                         │ NS │ project.example.com │ ns1.strettch.com ───┐   │
                         │ NS │ project.example.com │ ns2.strettch.com ───┤   │
                         └─────────────────────────────────────────────────┼───┘
                                                                           │
                                      ┌────────────────────────────────────▼─────────────────┐
                                      │ Strettch Cloud DNS (project.example.com zone)        │
                                      ├──────────────────────────────────────────────────────┤
                                      │ A │ db.project.example.com  │ 120.20.20.20          │
                                      │ A │ api.project.example.com │ 120.20.20.21          │
                                      └──────────────────────────────────────────────────────┘

DNS Query Flow:
1. User queries db.project.example.com
2. Registrar returns: "Ask ns1.cloudflare.com"
3. Cloudflare returns: "Ask ns1.strettch.com for project.example.com"
4. Strettch Cloud returns: "120.20.20.20"
```

### Important Limitation

<Warning>
**What's NOT Supported**

You cannot create a subdomain as an independent DNS zone using **Strettch Cloud's nameservers** when the parent domain also uses Strettch Cloud's nameservers.

**Example of What's NOT Possible:**

**Mermaid Diagram:**
```mermaid
graph TB
    subgraph "❌ NOT SUPPORTED"
        P[strettchcloud.com<br/>NS: ns1.strettch.com<br/>NS: ns2.strettch.com]
        S[project.strettchcloud.com<br/>NS: ns1.strettch.com<br/>NS: ns2.strettch.com]
        P -.->|Cannot delegate<br/>to same provider| S
    end

    style P fill:#ffebee
    style S fill:#ffebee
```

**ASCII Diagram:**
```
❌ NOT SUPPORTED:

strettchcloud.com
 ├─ Nameservers: ns1.strettch.com, ns2.strettch.com ✅
 └─ NS record: project → ns1.strettch.com, ns2.strettch.com ❌

    project.strettchcloud.com (as separate zone)
     └─ Nameservers: ns1.strettch.com, ns2.strettch.com ❌
```

In this scenario, you cannot manage `project.strettchcloud.com` as its own independent domain zone with isolated DNS records within Strettch Cloud.

**What IS Supported**

**Option 1: Delegate Subdomain to External DNS Providers**

**Mermaid Diagram:**
```mermaid
graph TB
    subgraph "✅ SUPPORTED"
        P1[strettchcloud.com<br/>NS: ns1.strettch.com]
        S1[project.strettchcloud.com<br/>NS: ns1.vercel-dns.com<br/>Managed on Vercel]
        P1 -->|Delegates to<br/>external provider| S1
    end

    style P1 fill:#e8f5e9
    style S1 fill:#e8f5e9
```

**ASCII Diagram:**
```
✅ SUPPORTED - Delegate to External Provider:

┌────────────────────────────────────────┐
│ Strettch Cloud DNS                     │
│ strettchcloud.com                      │
├────────────────────────────────────────┤
│ NS: ns1.strettch.com                   │
│ NS record: project → ns1.vercel-dns.com│──────┐
└────────────────────────────────────────┘      │
                                                 │
                        ┌────────────────────────▼───────────────┐
                        │ Vercel DNS                             │
                        │ project.strettchcloud.com              │
                        ├────────────────────────────────────────┤
                        │ NS: ns1.vercel-dns.com                 │
                        │ A: api.project → 76.76.21.21           │
                        └────────────────────────────────────────┘
```

**Option 2: Delegate Subdomain to Strettch Cloud from External Provider**

**Mermaid Diagram:**
```mermaid
graph TB
    subgraph "✅ SUPPORTED"
        P2[strettchcloud.com<br/>NS: ns.cloudflare.com<br/>Managed on Cloudflare]
        S2[project.strettchcloud.com<br/>NS: ns1.strettch.com<br/>Managed on Strettch]
        P2 -->|Delegates to<br/>Strettch Cloud| S2
    end

    style P2 fill:#e8f5e9
    style S2 fill:#e8f5e9
```

**ASCII Diagram:**
```
✅ SUPPORTED - Delegate from External Provider:

┌────────────────────────────────────────┐
│ Cloudflare DNS                         │
│ strettchcloud.com                      │
├────────────────────────────────────────┤
│ NS: ns.cloudflare.com                  │
│ NS record: project → ns1.strettch.com  │──────┐
└────────────────────────────────────────┘      │
                                                 │
                        ┌────────────────────────▼───────────────┐
                        │ Strettch Cloud DNS                     │
                        │ project.strettchcloud.com              │
                        ├────────────────────────────────────────┤
                        │ NS: ns1.strettch.com                   │
                        │ A: api.project → 120.20.20.21          │
                        └────────────────────────────────────────┘
```

**What This Means for You:**

- ✅ You can add any subdomain records directly in your main domain (e.g., `api.project.strettchcloud.com`)
- ✅ You can delegate subdomains to external DNS providers like AWS Route 53, Vercel, or Cloudflare
- ✅ You can delegate subdomains TO Strettch Cloud when the parent domain is hosted elsewhere
- ❌ You cannot create subdomain zones that also use Strettch Cloud's nameservers when the parent is on Strettch Cloud
</Warning>
