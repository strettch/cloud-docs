name: Changelog Release Notification

on:
  workflow_dispatch:
    inputs:
      release_summary:
        description: 'The final, short summary of the release to be sent to the API.'
        required: true
        default: 'Major platform stability and performance improvements.'
      version_tag:
        description: 'The version tag (e.g., v1.5.0) associated with this release.'
        required: false
        default: 'vX.Y.Z'
      
jobs:
  notify_backend:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Install dependencies
        run: npm install --prefix .github/scripts

      - name: Execute Release Notification Script
        run: node .github/scripts/notify-backend.js
        env:
          RELEASE_SUMMARY: ${{ github.event.inputs.release_summary }}
          VERSION_TAG: ${{ github.event.inputs.version_tag }}
          BACKEND_API_SECRET: ${{ secrets.CHANGELOG_API_SECRET }}